{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{59:function(t,s,n){\"use strict\";n.r(s);var a=n(0),o=Object(a.a)({},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n(\"div\",{staticClass:\"content\"},[t._m(0),t._m(1),t._m(2),n(\"div\",{staticClass:\"danger custom-block\"},[n(\"p\",{staticClass:\"custom-block-title\"},[t._v(\"node js-sdk 授权\")]),n(\"ul\",[n(\"li\",[n(\"router-link\",{attrs:{to:\"微信授权和sdk加密算法.html\"}},[t._v(\"公众平台的技术文档目的为了简明扼要的交代接口的使用，语句难免晦涩，这里写了些了我所理解的微信开放平台中关于利用node.js使用授权和js-sdk的一些方法，详情请见微信公众平台.如果用户在微信客户端中访问第三方网页，公众号可以通过微信网页授权机制，来获取用户基本信息，进而实现业务逻辑。随着微信管控越发严厉，像一些最基本的网页转发都需要授权处理才能获取到图片和描述，描述审查也是相当严格。#\")])],1)])]),t._m(3),t._m(4),n(\"hr\"),t._m(5),t._m(6),n(\"hr\"),t._m(7),t._m(8),t._m(9),t._m(10),t._m(11),t._m(12),t._m(13),t._m(14),t._m(15),t._m(16),t._m(17),t._m(18),t._m(19),t._m(20),t._m(21),t._m(22),t._m(23),t._m(24),t._m(25),t._m(26),t._m(27),t._m(28),t._m(29),t._m(30),t._m(31),t._m(32),t._m(33),t._m(34),t._m(35),t._m(36),t._m(37),t._m(38),n(\"p\",[t._v(\"public/js/userList.js\")]),t._m(39),t._m(40),t._m(41),t._m(42),n(\"hr\"),t._m(43),t._m(44),n(\"hr\"),t._m(45)])},[function(){var t=this.$createElement,s=this._self._c||t;return s(\"h2\",{attrs:{id:\"➣-准备工作：\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#➣-准备工作：\",\"aria-hidden\":\"true\"}},[this._v(\"#\")]),this._v(\" ➣ 准备工作：\")])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"ul\",[s(\"li\",[this._v(\"申请服务器 公众号 基本配置 这些\"),s(\"a\",{attrs:{href:\"https://mp.weixin.qq.com/wiki?t=resource/res_main&id=mp1472017492_58YV5\",target:\"_blank\",rel:\"noopener noreferrer\"}},[this._v(\"微信公众平台\")]),this._v(\"上都有，就不介绍了，接下来进入正题。\")])])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"h2\",{attrs:{id:\"➣-微信网页授权\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#➣-微信网页授权\",\"aria-hidden\":\"true\"}},[this._v(\"#\")]),this._v(\" ➣ 微信网页授权\")])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"h3\",{attrs:{id:\"网页授权回调域名的说明\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#网页授权回调域名的说明\",\"aria-hidden\":\"true\"}},[this._v(\"#\")]),this._v(\" 网页授权回调域名的说明\")])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"ul\",[s(\"li\",[s(\"p\",[this._v(\"在微信公众号请求用户网页授权之前，开发者需要先到公众平台官网中的“开发 - 接口权限 - 网页服务 - 网页帐号 - 网页授权获取用户基本信息”的配置选项中，修改授权回调域名。请注意，这里填写的是域名（是一个字符串），而不是URL，因此请勿加 http:// 等协议头；\")])]),s(\"li\",[s(\"p\",[this._v(\"授权回调域名配置规范为全域名，比如需要网页授权的域名为：www.qq.com，配置以后此域名下面的页面http://www.qq.com/music.html 、 http://www.qq.com/login.html 都可以进行OAuth2.0鉴权。但http://pay.qq.com 、 http://music.qq.com 、 http://qq.com无法进行OAuth2.0鉴权\")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"h3\",{attrs:{id:\"网页授权的两种scope的区别（snsapi-base-snsapi-userinfo）\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#网页授权的两种scope的区别（snsapi-base-snsapi-userinfo）\",\"aria-hidden\":\"true\"}},[this._v(\"#\")]),this._v(\" 网页授权的两种scope的区别（snsapi_base snsapi_userinfo）\")])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"ul\",[s(\"li\",[s(\"p\",[this._v(\"以snsapi_base为scope发起的网页授权，是用来获取进入页面的用户的openid的，并且是静默授权并自动跳转到回调页的。用户感知的就是直接进入了回调页（往往是业务页面）\")])]),s(\"li\",[s(\"p\",[this._v(\"以snsapi_userinfo为scope发起的网页授权，是用来获取用户的基本信息的。但这种授权需要用户手动同意，并且由于用户同意过，所以无须关注，就可在授权后获取该用户的基本信息。\")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"h3\",{attrs:{id:\"网页授权access-token和普通access-token的区别\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#网页授权access-token和普通access-token的区别\",\"aria-hidden\":\"true\"}},[this._v(\"#\")]),this._v(\" 网页授权access_token和普通access_token的区别\")])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"ul\",[s(\"li\",[s(\"p\",[this._v(\"微信网页授权是通过OAuth2.0机制实现的，在用户授权给公众号后，公众号可以获取到一个网页授权特有的接口调用凭证（网页授权access_token），通过网页授权access_token可以进行授权后接口调用，如获取用户基本信息；\")])]),s(\"li\",[s(\"p\",[this._v(\"其他微信接口，需要通过基础支持中的“获取access_token”接口来获取到的普通access_token调用。\")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"h2\",{attrs:{id:\"➣-具体步骤：\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#➣-具体步骤：\",\"aria-hidden\":\"true\"}},[this._v(\"#\")]),this._v(\" ➣ 具体步骤：\")])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"h2\",{attrs:{id:\"代码配置：\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#代码配置：\",\"aria-hidden\":\"true\"}},[this._v(\"#\")]),this._v(\" * 代码配置：\")])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"ul\",[s(\"li\",[this._v(\"package.json\")])])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n(\"pre\",{pre:!0,attrs:{class:\"language-js\"}},[n(\"code\",[n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n  \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"name\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"js-sdk\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n  \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"version\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"1.0.0\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"highlighted-line\"}},[t._v(\"  \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"description\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")])]),t._v(\"  \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"main\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"app.js\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n  \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"scripts\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"test\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"echo \\\\\"Error: no test specified\\\\\" && exit 1\"')]),t._v(\"\\n  \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n  \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"author\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n  \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"license\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"ISC\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n  \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"dependencies\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"babel-runtime\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^6.26.0\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"body-parser\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^1.18.2\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"cheerio\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^1.0.0-rc.2\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"connect-mongo\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^2.0.1\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"connect-redis\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^3.3.3\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"cookie-parser\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^1.4.3\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"crypto\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^1.0.1\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"ejs\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^2.5.7\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"express\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^4.16.2\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"express-session\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^1.15.6\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"fs\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^0.0.1-security\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"mongoose\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^5.0.16\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"morgan\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^1.9.0\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"redis\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^2.8.0\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"request\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^2.83.0\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"sha1\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^1.1.1\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"util\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^0.10.3\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"utility\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^1.13.1\"')]),t._v(\"\\n  \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n  \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"devDependencies\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"babel-core\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^6.26.0\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"babel-plugin-transform-runtime\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^6.23.0\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"babel-preset-es2015\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^6.24.1\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"gulp\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^3.9.1\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"gulp-autoprefixer\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^4.1.0\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"gulp-babel\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^7.0.0\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"gulp-concat\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^2.6.1\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"gulp-connect\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^5.2.0\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"gulp-imagemin\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^4.1.0\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"gulp-minify-css\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^1.2.4\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"gulp-minify-html\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^1.0.6\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"gulp-px2rem-plugin\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^0.4.0\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"gulp-uglify\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^3.0.0\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"gulp-util\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"^3.0.8\"')]),t._v(\"\\n  \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\\n\")])])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"ul\",[s(\"li\",[this._v(\"app.js\")])])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n(\"pre\",{pre:!0,attrs:{class:\"language-js\"}},[n(\"code\",[n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"const\")]),t._v(\" express \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"require\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"express\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"const\")]),t._v(\" bodyParser \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"require\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"body-parser\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"const\")]),t._v(\" path \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"require\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"path\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"highlighted-line\"}},[n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"const\")]),t._v(\" logger \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"require\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"morgan\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")])]),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"const\")]),t._v(\" cookieParser \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"require\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"cookie-parser\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"const\")]),t._v(\" indexRoute \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"require\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"./app/routes/index.route\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"const\")]),t._v(\" app \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"express\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\\n\\napp\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"set\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"'views'\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" path\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"join\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"__dirname\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"'app/views'\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\napp\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"set\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"'view engine'\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"'ejs'\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\\n\"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"/*配置静态文件路径*/\")]),t._v(\"\\napp\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"use\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"express\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"static\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"path\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"join\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"__dirname\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"public\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\\n\"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"/*配置请求日志*/\")]),t._v(\"\\napp\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"use\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"logger\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"dev\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\\n\"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"/*解析application/json格式数据*/\")]),t._v(\"\\napp\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"use\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"bodyParser\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"json\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\\n\"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"/*解析application/www-x-form-urlencoded格式数据*/\")]),t._v(\"\\napp\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"use\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"bodyParser\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"urlencoded\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"extended\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token boolean\"}},[t._v(\"false\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\\n\"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"/*解析cookie*/\")]),t._v(\"\\napp\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"use\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"cookieParser\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\\n\"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"/*解析session*/\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"const\")]),t._v(\" session \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"require\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"'express-session'\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\napp\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"use\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"session\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    secret\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"123456\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"//建议使用随机字符串\")]),t._v(\"\\n    resave\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token boolean\"}},[t._v(\"true\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    saveUninitialized\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token boolean\"}},[t._v(\"true\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n    cookie\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"maxAge\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"24\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"*\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"60\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"*\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"60\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"*\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"1000\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\\n\"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"/*配置路由*/\")]),t._v(\"\\napp\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"use\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"/\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" indexRoute\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\\napp\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"use\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"res\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"next\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=>\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" err \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"new\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token class-name\"}},[t._v(\"Error\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"Error 404, the source is not found!\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    err\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"status \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"404\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"next\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"err\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\\napp\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"use\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"err\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" res\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" next\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=>\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"err\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    res\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"status\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"err\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"status \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"||\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"500\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"send\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"err\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"message\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"next\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\\nmodule\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"exports \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" app\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\")])])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"ul\",[s(\"li\",[this._v(\"config/env.config.js\")])])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n(\"pre\",{pre:!0,attrs:{class:\"language-js\"}},[n(\"code\",[t._v(\"module\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"exports \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n  port\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"80\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n\\t\"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"token\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"yourtoken\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"highlighted-line\"}},[t._v(\"\\t\"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"appID\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"***\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")])]),t._v(\"\\t\"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"appsecret\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"***\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n\\t\"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"userAppID\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"***\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n\\t\"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"userAppSecret\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"***\"')]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\")])])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"ul\",[s(\"li\",[this._v(\"app/routes/index.routes.js\")])])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n(\"pre\",{pre:!0,attrs:{class:\"language-js\"}},[n(\"code\",[n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"const\")]),t._v(\" express \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"require\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"'express'\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"const\")]),t._v(\" path \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"require\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"path\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"const\")]),t._v(\" authMiddleware \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"require\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"../middlewares/auth.middleware\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"highlighted-line\"}},[n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"const\")]),t._v(\" router \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" express\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"Router\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")])]),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"const\")]),t._v(\" querystring \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"require\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"'querystring'\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"const\")]),t._v(\" url \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"require\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"'url'\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"const\")]),t._v(\" cheerio \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"require\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"'cheerio'\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\n\\nrouter\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"get\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"/\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" authMiddleware\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"getCode\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"res\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"next\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=>\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    res\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"sendFile\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"path\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"join\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"__dirname\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"../views/index.html\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\n\\n\")])])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"ul\",[s(\"li\",[this._v(\"app/views/index.html\")])])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n(\"pre\",{pre:!0,attrs:{class:\"language-js\"}},[n(\"code\",[n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"!\")]),t._v(\"doctype html\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),t._v(\"html lang\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"en\"')]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),t._v(\"head\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"highlighted-line\"}},[t._v(\"    \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),t._v(\"meta charset\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"UTF-8\"')]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")])]),t._v(\"    \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),t._v(\"meta name\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"viewport\"')]),t._v(\"\\n          content\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0\"')]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),t._v(\"meta http\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"equiv\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"X-UA-Compatible\"')]),t._v(\" content\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"ie=edge\"')]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),t._v(\"title\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"Document\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"title\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"head\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),t._v(\"body\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"\\n    这里只是测试getCode成功与否\\n\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"body\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"html\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"\\n\")])])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"ul\",[s(\"li\",[s(\"p\",[this._v(\"新建 app/config.access_token.json待用\")])]),s(\"li\",[s(\"p\",[this._v(\"新建 app/config.ticket.json待用\")])]),s(\"li\",[s(\"p\",[this._v(\"app/middlewares/auth.middlewares.js\")])])])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n(\"pre\",{pre:!0,attrs:{class:\"language-js\"}},[n(\"code\",[t._v(\"exports\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function-variable function\"}},[t._v(\"getUserInfo\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"res\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"next\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=>\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"<-----------------获取getUserInfo---------------------\\x3e\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\n    console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"'-----\\x3ereq.access_token : '\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\"req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"access_token\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"highlighted-line\"}},[t._v(\"    \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" access_token \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"access_token\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")])]),t._v(\"    \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" openid \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"openid\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" url \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token template-string\"}},[n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"`https://api.weixin.qq.com/sns/userinfo?access_token=\")]),n(\"span\",{attrs:{class:\"token interpolation\"}},[n(\"span\",{attrs:{class:\"token interpolation-punctuation punctuation\"}},[t._v(\"${\")]),t._v(\"access_token\"),n(\"span\",{attrs:{class:\"token interpolation-punctuation punctuation\"}},[t._v(\"}\")])]),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"&openid=\")]),n(\"span\",{attrs:{class:\"token interpolation\"}},[n(\"span\",{attrs:{class:\"token interpolation-punctuation punctuation\"}},[t._v(\"${\")]),t._v(\"openid\"),n(\"span\",{attrs:{class:\"token interpolation-punctuation punctuation\"}},[t._v(\"}\")])]),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"&lang=zh_CN`\")])]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"request\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"url\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"err\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"httpResponse\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"body\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=>\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"----\\x3e--通过access_token和openid获取到的用户个人信息 :\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\n        console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"body\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" result \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token constant\"}},[t._v(\"JSON\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"parse\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"body\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        res\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"cookie\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"openid\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"openid\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"maxAge\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"24\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"*\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"60\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"*\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"60\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"*\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"1000\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" httpOnly\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token boolean\"}},[t._v(\"false\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        res\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"cookie\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"nickname\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"nickname\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"maxAge\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"24\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"*\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"60\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"*\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"60\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"*\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"1000\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" httpOnly\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token boolean\"}},[t._v(\"false\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        res\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"cookie\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"headimgurl\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"headimgurl\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"maxAge\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"24\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"*\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"60\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"*\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"60\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"*\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"10000\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" httpOnly\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token boolean\"}},[t._v(\"false\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        res\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"cookie\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"unionid\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"unionid\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"maxAge\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"24\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"*\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"60\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"*\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"60\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"*\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"1000\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" httpOnly\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token boolean\"}},[t._v(\"false\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"next\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\")])])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"h2\",{attrs:{id:\"以snsapi-base为scope发起的授权\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#以snsapi-base为scope发起的授权\",\"aria-hidden\":\"true\"}},[this._v(\"#\")]),this._v(\" * 以snsapi_base为scope发起的授权\")])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"h3\",{attrs:{id:\"第一步：用户同意授权，获取code\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#第一步：用户同意授权，获取code\",\"aria-hidden\":\"true\"}},[this._v(\"#\")]),this._v(\" 第一步：用户同意授权，获取code\")])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"ul\",[s(\"li\",[this._v(\"app/middleares/auth.middlewares.js\")])])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n(\"pre\",{pre:!0,attrs:{class:\"language-js\"}},[n(\"code\",[n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"const\")]),t._v(\" config \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"require\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"../../config/env.config\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"const\")]),t._v(\" request \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"require\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"request\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"const\")]),t._v(\" appid \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" config\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"appID\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"highlighted-line\"}},[n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"const\")]),t._v(\" appsecret \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" config\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"appsecret\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")])]),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"/*获取code*/\")]),t._v(\"\\nexports\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function-variable function\"}},[t._v(\"getCode\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"function\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"res\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"next\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"'--|cookies : '\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token constant\"}},[t._v(\"JSON\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"stringify\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"cookies\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"if\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"cookies\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"openid\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"next\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"else\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" back_url \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"escape\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"url\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"//解码，解决url？后面参数返回消失问题 2.req.url 获取URL\")]),t._v(\"\\n        console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"'获取的url路由参数为 ：'\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\"back_url\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" redirect_uri \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token template-string\"}},[n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"`{你的域名}/getUserInfo?back_url=\")]),n(\"span\",{attrs:{class:\"token interpolation\"}},[n(\"span\",{attrs:{class:\"token interpolation-punctuation punctuation\"}},[t._v(\"${\")]),t._v(\"back_url\"),n(\"span\",{attrs:{class:\"token interpolation-punctuation punctuation\"}},[t._v(\"}\")])]),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"`\")])]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"    \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"//注意这里执行了getUserInfo路由\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" url \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token template-string\"}},[n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"`https://open.weixin.qq.com/connect/oauth2/authorize?appid=\")]),n(\"span\",{attrs:{class:\"token interpolation\"}},[n(\"span\",{attrs:{class:\"token interpolation-punctuation punctuation\"}},[t._v(\"${\")]),t._v(\"appid\"),n(\"span\",{attrs:{class:\"token interpolation-punctuation punctuation\"}},[t._v(\"}\")])]),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"&redirect_uri=\")]),n(\"span\",{attrs:{class:\"token interpolation\"}},[n(\"span\",{attrs:{class:\"token interpolation-punctuation punctuation\"}},[t._v(\"${\")]),t._v(\"redirect_uri\"),n(\"span\",{attrs:{class:\"token interpolation-punctuation punctuation\"}},[t._v(\"}\")])]),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect `\")])]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"'重定向的url : '\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\"url\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"//next();\")]),t._v(\"\\n        res\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"redirect\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"url\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"//res.redirect()重定向跳转 参数仅为URL时和res.location(url)一样\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\")])])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"h3\",{attrs:{id:\"第二步：通过code换取网页授权access-token\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#第二步：通过code换取网页授权access-token\",\"aria-hidden\":\"true\"}},[this._v(\"#\")]),this._v(\" 第二步：通过code换取网页授权access_token\")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n(\"pre\",{pre:!0,attrs:{class:\"language-js\"}},[n(\"code\",[n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"/*获取access_token*/\")]),t._v(\"\\nexports\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function-variable function\"}},[t._v(\"getAccess_token\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"res\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"next\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=>\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"<------------------获取snsapi_base access_token-----------------------\\x3e\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"highlighted-line\"}},[t._v(\"    console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token constant\"}},[t._v(\"JSON\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"stringify\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"query\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")])]),t._v(\"    \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" code \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"query\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"code\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" url \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token template-string\"}},[n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"`https://api.weixin.qq.com/sns/oauth2/access_token?appid=\")]),n(\"span\",{attrs:{class:\"token interpolation\"}},[n(\"span\",{attrs:{class:\"token interpolation-punctuation punctuation\"}},[t._v(\"${\")]),t._v(\"appid\"),n(\"span\",{attrs:{class:\"token interpolation-punctuation punctuation\"}},[t._v(\"}\")])]),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"&secret=\")]),n(\"span\",{attrs:{class:\"token interpolation\"}},[n(\"span\",{attrs:{class:\"token interpolation-punctuation punctuation\"}},[t._v(\"${\")]),t._v(\"appsecret\"),n(\"span\",{attrs:{class:\"token interpolation-punctuation punctuation\"}},[t._v(\"}\")])]),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"&code=\")]),n(\"span\",{attrs:{class:\"token interpolation\"}},[n(\"span\",{attrs:{class:\"token interpolation-punctuation punctuation\"}},[t._v(\"${\")]),t._v(\"code\"),n(\"span\",{attrs:{class:\"token interpolation-punctuation punctuation\"}},[t._v(\"}\")])]),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"&grant_type=authorization_code `\")])]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"request\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"url\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"err\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" httpResponse\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" body\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=>\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"err\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"'--||--code换取的所有信息 ：'\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\"body\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" result \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token constant\"}},[t._v(\"JSON\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"parse\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"body\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"access_token \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"access_token\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"openid \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"openid\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"next\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\\n\")])])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"h3\",{attrs:{id:\"第三步：拉取用户信息-需scope为-snsapi-userinfo\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#第三步：拉取用户信息-需scope为-snsapi-userinfo\",\"aria-hidden\":\"true\"}},[this._v(\"#\")]),this._v(\" 第三步：拉取用户信息(需scope为 snsapi_userinfo)\")])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"ul\",[s(\"li\",[this._v(\"/getUserInfo使用了getAccess_token  getUserInfo 中间件 在code没过期的情况下可以进一步获取access_token 和个人信息\")])])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n(\"pre\",{pre:!0,attrs:{class:\"language-js\"}},[n(\"code\",[t._v(\"router\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"get\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"/getUserInfo\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" authMiddleware\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"getAccess_token\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" authMiddleware\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"getUserInfo\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"function\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" res\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" next\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"\\\"<------------------'/getUserInfo'-----------------------\\x3e\\\"\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"'-----\\x3e|查询的url字符串参数 ：'\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token constant\"}},[t._v(\"JSON\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"stringify\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"query\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"highlighted-line\"}},[t._v(\"    \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" back_url \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"query\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"back_url\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")])]),t._v(\"    \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"for\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" item \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"in\")]),t._v(\" req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"query\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"if\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"item \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"!==\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"back_url\"')]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"&&\")]),t._v(\" item \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"!==\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"code\"')]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"&&\")]),t._v(\" item \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"!==\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"state\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n            back_url \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"+=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"&\"')]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\" item \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"=\"')]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\" req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"query\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),t._v(\"item\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"'----\\x3e|重新筛选路径back_url : '\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\" back_url\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    res\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"redirect\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"back_url\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\")])])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"h2\",{attrs:{id:\"以snsapi-userinfo为scope发起的授权\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#以snsapi-userinfo为scope发起的授权\",\"aria-hidden\":\"true\"}},[this._v(\"#\")]),this._v(\" * 以snsapi_userinfo为scope发起的授权\")])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"ul\",[s(\"li\",[this._v(\"app/middlewares/accessToken.middlesware.js\")])])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n(\"pre\",{pre:!0,attrs:{class:\"language-js\"}},[n(\"code\",[n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" weixinConfig \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"require\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"../../config/env.config.js\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" request \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"require\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"request\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" fs \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"require\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"fs\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"highlighted-line\"}}),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"//获取accessToken\")]),t._v(\"\\nexports\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function-variable function\"}},[t._v(\"accessToken\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"function\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" res\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" next\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"\\\"<------------------'获取snsapi_userinfo accessToken'-----------------------\\x3e\\\"\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" valide \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"isValide\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"//{ code: 0, result: result.access_token } or{code:1001}\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"if\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"valide\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"code \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"===\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"0\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"//access_token还没过期，用以前的\")]),t._v(\"\\n        req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"query\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"access_token \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" valide\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"next\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"else\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"//重新获取access_token && expire_in\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" appid \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" weixinConfig\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"appID\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" secret \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" weixinConfig\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"appsecret\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" url \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&appid=\"')]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\" appid \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"&secret=\"')]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\" secret\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"request\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"url\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"function\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"error\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" response\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" body\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n            \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" result \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token constant\"}},[t._v(\"JSON\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"parse\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"body\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n            \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" now \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"new\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token class-name\"}},[t._v(\"Date\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"getTime\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"//new Date().getTime() 获得的是毫秒\")]),t._v(\"\\n            result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"expires_in \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" now \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"expires_in \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"20\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"*\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"1000\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"//expire_in一般是7200s 提前20毫秒\")]),t._v(\"\\n\\n            req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"query\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"access_token \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"access_token\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"//new access_token\")]),t._v(\"\\n            req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"query\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"tokenExpired \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"expires_in\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"// 7200s\")]),t._v(\"\\n            \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"next\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\\n\"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"//获取ticket\")]),t._v(\"\\nexports\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function-variable function\"}},[t._v(\"ticket\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"function\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" res\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" next\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"\\\"<------------------'获取ticket'-----------------------\\x3e\\\"\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" ticketResult \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"isTicket\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"if\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"ticketResult\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"code \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"===\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"0\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"'已经有了ticket : '\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token constant\"}},[t._v(\"JSON\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"stringify\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"ticketResult\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"query\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"ticket \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" ticketResult\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"next\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"else\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"开始获取ticket\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" access_token \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"query\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"access_token\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" _tokenResult \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n            access_token\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"query\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"access_token\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n            expires_in\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"query\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"tokenExpired\\n        \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" url \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"https://api.weixin.qq.com/cgi-bin/ticket/getticket?access_token=\"')]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\" access_token \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"&type=jsapi\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"request\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"url\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"function\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"err\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" response\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" body\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n            \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" result \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token constant\"}},[t._v(\"JSON\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"parse\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"body\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n            console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n            \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"if\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"errcode \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"==\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"0\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n                \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" now \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"new\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token class-name\"}},[t._v(\"Date\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"getTime\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n                result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"expires_in \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" now \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"expires_in \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"20\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"*\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"1000\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"//   改变时间为当前时间的两小时后\")]),t._v(\"\\n                fs\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"writeFileSync\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"./config/access_token.json\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token constant\"}},[t._v(\"JSON\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"stringify\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"_tokenResult\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"//fs.writeFileSync:以同步的方式将data写入文件，文件已存在的情况下，原内容将被替换。\")]),t._v(\"\\n                fs\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"writeFileSync\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"./config/ticket.json\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token constant\"}},[t._v(\"JSON\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"stringify\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n                console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"'异步写入access_token ticket.json'\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n                req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"query\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"ticket \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"ticket\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n                \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"next\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n            \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\\n\"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"function\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"isValide\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"//有效\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" result \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" fs\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"readFileSync\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"./config/access_token.json\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"toString\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"//同步读取json文件 //这里用toString的原因：读出来的数据是一堆包含着16进制数字的对象，必须通过toString转为字符串形式\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"if\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        result \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token constant\"}},[t._v(\"JSON\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"parse\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" now \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"new\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token class-name\"}},[t._v(\"Date\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"getTime\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"if\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"access_token \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"&&\")]),t._v(\" result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"expires_in \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"&&\")]),t._v(\" now \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),t._v(\" result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"expires_in\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n            console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"access_token 还在7200s以内，没有过期\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"//access_token有效 expires_in应该指的是距离生成时间的7200秒后\")]),t._v(\"\\n            \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"return\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\" code\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"0\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"access_token \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"else\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n            console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"access_token 失效\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n            \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"return\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\" code\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"1001\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"else\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"return\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\" code\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"1001\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\\n\"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"function\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"isTicket\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" result \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" fs\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"readFileSync\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"./config/ticket.json\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"toString\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"result:\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"if\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        result \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token constant\"}},[t._v(\"JSON\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"parse\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" now \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"new\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token class-name\"}},[t._v(\"Date\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"getTime\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"if\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"ticket \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"&&\")]),t._v(\" result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"expires_in \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"&&\")]),t._v(\" now \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),t._v(\" result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"expires_in\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n            console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"ticket有效，沿用当前ticket.json里的ticket\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n            \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"return\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\" code\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"0\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"ticket \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"else\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n            console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"ticket无效需要获取\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n            \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"return\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\" code\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"1001\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"else\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"return\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\" code\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"1001\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\")])])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"ul\",[s(\"li\",[s(\"p\",[this._v(\"accessToken.middlesware.js写了关于获取以snsapi_userinfo为scope发起的网页授权的access_token ticket,并用fs以json字符串的形式存到本地，并检测过期时间，如果没过期就继续读取使用，如果过期就重新获取并储存在心的access_token ticket到本地\")])]),s(\"li\",[s(\"p\",[this._v(\"app/routes/index.routes.js\")])])])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n(\"pre\",{pre:!0,attrs:{class:\"language-js\"}},[n(\"code\",[t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"const\")]),t._v(\" crypto \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"require\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"crypto\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"const\")]),t._v(\" sha1 \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"require\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"sha1\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"highlighted-line\"}},[n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"const\")]),t._v(\" accessTokenMiddle \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"require\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"../middlewares/accessToken.middleware.js\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")])]),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"const\")]),t._v(\" weixin \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"require\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"../../config/env.config\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\\nrouter\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"get\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"/weixin\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" accessTokenMiddle\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"accessToken\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" accessTokenMiddle\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"ticket\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"function\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" res\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" next\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"\\\"<------------------'/weixin'-----------------------\\x3e\\\"\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"'-----\\x3e| req.query : '\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token constant\"}},[t._v(\"JSON\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"stringify\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"query\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    crypto\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"randomBytes\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"16\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"function\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"ex\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" buf\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" appId \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" weixin\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"appID\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" noncestr \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" buf\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"toString\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"hex\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" jsapi_ticket \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"query\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"ticket\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" timestamp \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"new\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token class-name\"}},[t._v(\"Date\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"getTime\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        timestamp \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"parseInt\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"timestamp \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"1000\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" url \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" req\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"query\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"url\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"参数 ：\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"noncestr\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"jsapi_ticket\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"timestamp\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"url\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\\n        \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" str \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"noncestr=\"')]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\" noncestr\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"jsapi_ticket=\"')]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\" jsapi_ticket\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"timestamp=\"')]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\" timestamp\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"url=\"')]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\" url\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"sort\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"join\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"&\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"待混淆加密的字符串 ： \"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"str\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" signature \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"sha1\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"str\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\\n        console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"微信sdk签名signature ：\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n        console\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"log\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"signature\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\\n        \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" result \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\" code\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"0\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\" appId\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" appId\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" timestamp\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" timestamp\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" nonceStr\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" noncestr\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" signature\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" signature \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\\n        res\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"json\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"//res.json 等同于将一个对象或数组传到给res.send()\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\\n\")])])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"ul\",[s(\"li\",[this._v(\"在html页面使用微信公众平台提供的API 需要引用 http://res.wx.qq.com/open/js/jweixin-1.2.0.js\")]),s(\"li\",[this._v(\"在静态文件中调用分享功能的api 更多API请打开\\n\"),s(\"a\",{attrs:{href:\"https://mp.weixin.qq.com/wiki?t=resource/res_main&id=mp1421141115\",target:\"_blank\",rel:\"noopener noreferrer\"}},[this._v(\"# 微信JS-SDK说明文档\")])]),s(\"li\",[this._v(\"public/index.html\")])])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n(\"pre\",{pre:!0,attrs:{class:\"language-js\"}},[n(\"code\",[n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"!\")]),t._v(\"doctype html\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),t._v(\"html lang\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"en\"')]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),t._v(\"head\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"highlighted-line\"}},[t._v(\"    \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),t._v(\"meta charset\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"UTF-8\"')]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")])]),t._v(\"    \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),t._v(\"meta name\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"viewport\"')]),t._v(\"\\n          content\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0\"')]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),t._v(\"meta http\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"equiv\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"X-UA-Compatible\"')]),t._v(\" content\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"ie=edge\"')]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),t._v(\"title\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"Document\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"title\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"head\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),t._v(\"body\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),t._v(\"p\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"userList\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"...\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"p\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),t._v(\"button style\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"color:purple;\"')]),t._v(\" onclick\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"clickMe()\"')]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"clickMe\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"button\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"body\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),t._v(\"script src\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"http://www.jq22.com/jquery/jquery-2.1.1.js\"')]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"script\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),t._v(\"script src\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"http://res.wx.qq.com/open/js/jweixin-1.2.0.js\"')]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"script\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),t._v(\"script src\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"../js/userList.js\"')]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"script\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"<\")]),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"html\"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"\\n\")])])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n(\"pre\",{pre:!0,attrs:{class:\"language-js\"}},[n(\"code\",[n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" signatureUrl \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" url\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"split\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"#\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"0\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token constant\"}},[t._v(\"URL\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"encodeURIComponent\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"signatureUrl\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\\n\"),n(\"span\",{attrs:{class:\"highlighted-line\"}}),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" title \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"这是分享的表标题\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" desc \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"this is description\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" shareUrl \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" window\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"location\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"href\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"let\")]),t._v(\" logo \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"http://yizhenjia.com/dist/newImg/logo.png\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token constant\"}},[t._v(\"SHARE\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"title\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" desc\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" shareUrl\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" logo\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\" \\n\\n$\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"get\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"/weixin?url=\"')]),t._v(\" \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"+\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token constant\"}},[t._v(\"URL\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"function\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"if\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"code \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"==\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"0\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        wx\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"config\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n            debug\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token boolean\"}},[t._v(\"false\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"// 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。\")]),t._v(\"\\n            appId\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"appId\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"// 必填，公众号的唯一标识\")]),t._v(\"\\n            timestamp\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"timestamp\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"// 必填，生成签名的时间戳\")]),t._v(\"\\n            nonceStr\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"nonceStr\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"// 必填，生成签名的随机串\")]),t._v(\"\\n            signature\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"result\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"signature\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"// 必填，签名，见附录1\")]),t._v(\"\\n            jsApiList\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"onMenuShareAppMessage\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"onMenuShareTimeline\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"chooseImage\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"scanQRCode\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"getLocation\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"openLocation\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"// 必填，需要使用的JS接口列表，所有JS接口列表见附录2\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\\n\"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"function\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token constant\"}},[t._v(\"SHARE\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"title\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" desc\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" shareUrl\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" logo\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"        \\n    wx\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"ready\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"function\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"// config信息验证后会执行ready方法，所有接口调用都必须在config接口获得结果之后，config是一个客户端的异步操作，所以如果需要在页面加载时就调用相关接口，则须把相关接口放在ready函数中调用来确保正确执行。对于用户触发时才调用的接口，则可以直接调用，不需要放在ready函数中。\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"//分享\")]),t._v(\"\\n        wx\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"onMenuShareAppMessage\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n            title\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" title\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"// 分享标题\")]),t._v(\"\\n            desc\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" desc\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"// 分享描述\")]),t._v(\"\\n            link\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" shareUrl\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"// 分享链接\")]),t._v(\"\\n            imgUrl\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" logo\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"// 分享图标\")]),t._v(\"\\n            type\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"''\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"// 分享类型,music、video或link，不填默认为link\")]),t._v(\"\\n            dataUrl\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token string\"}},[t._v(\"''\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"// 如果type是music或video，则要提供数据链接，默认为空\")]),t._v(\"\\n            success\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"function\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n                用户确认分享后执行的回调函数\\n                \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"alert\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"分享成功！\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n            \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n            cancel\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"function\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n                \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"// 用户取消分享后执行的回调函数\")]),t._v(\"\\n            \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\"\\n            fail\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"function\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"err\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n                \"),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"alert\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token string\"}},[t._v('\"分享失败\"')]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n            \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    wx\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{attrs:{class:\"token function\"}},[t._v(\"error\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"function\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"res\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"// config信息验证失败会执行error函数，如签名过期导致验证失败，具体错误信息可以打开config的debug模式查看，也可以在返回的res参数中查看，对于SPA可以在这里更新签名。\")]),t._v(\"\\n        \"),n(\"span\",{attrs:{class:\"token comment\"}},[t._v('//alert(\"Error\");')]),t._v(\"\\n    \"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"      \\n\\n\")])])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"h2\",{attrs:{id:\"注释：\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#注释：\",\"aria-hidden\":\"true\"}},[this._v(\"#\")]),this._v(\" 注释：\")])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"ul\",[s(\"li\",[this._v(\"#微信开发必须在微信开发者工具上开发，且只能是默认80端口，在开发中经常有80端口被占用的情况，如果有请使用\")])])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n(\"pre\",{pre:!0,attrs:{class:\"language-js\"}},[n(\"code\",[t._v(\"lsof \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"i tcp\"),n(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\":\")]),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"80\")]),t._v(\"\\nkill \"),n(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"-\")]),n(\"span\",{attrs:{class:\"token number\"}},[t._v(\"9\")]),t._v(\" 进程\\n\")])])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"ul\",[s(\"li\",[this._v(\"#如果想在手机上测试 并抓包数据 可以使用charles抓包工具\")])])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"ol\",[s(\"li\",[this._v(\"打开charles 点击Proxy setting 设置 port\")]),s(\"li\",[this._v(\"保证手机和电脑处于同一Wi-Fi下，配置手动代理 输入IP和端口\\n查看ip地址 ：charles上可查看 或者终端输入ifconfig (cmd:ipconfig)\")]),s(\"li\",[this._v(\"扫码或使用地址即可访问\")])])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"ul\",[s(\"li\",[this._v(\"#在获取以snsapi_userinfo为scope发起的网页授权的时候使用的方式是fs储存到本地的方式，你也可以采用其他方式\")])])}],!1,null,null,null);s.default=o.exports}}]);","extractedComments":[]}