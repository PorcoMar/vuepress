<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PorcoMar Site | â¹ WePYæ€»ç»“</title>
    <meta name="description" content="Settle ğŸ€DUO in a golden house~ğŸ‘º">
    <link rel="shortcut icon" type="image/x-icon" href="https://gitee.com/uploads/6/1023506_PorcoMar.png?1500276509&quot; rel=&quot;shortcut icon">
    
    <link rel="preload" href="/assets/css/10.styles.322416e2.css" as="style"><link rel="preload" href="/assets/js/app.1a1b49cb.js" as="script"><link rel="preload" href="/assets/js/5.64c07d37.js" as="script"><link rel="prefetch" href="/assets/js/0.c2df6edd.js"><link rel="prefetch" href="/assets/js/1.56a7da20.js"><link rel="prefetch" href="/assets/js/2.3b4709dc.js"><link rel="prefetch" href="/assets/js/3.6f040e9c.js"><link rel="prefetch" href="/assets/js/4.84736aa4.js"><link rel="prefetch" href="/assets/js/6.86381ce2.js"><link rel="prefetch" href="/assets/js/7.7bd9e25c.js"><link rel="prefetch" href="/assets/js/8.7c781e0a.js"><link rel="prefetch" href="/assets/js/9.396615f7.js">
    <link rel="stylesheet" href="/assets/css/10.styles.322416e2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      PorcoMar Site
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/catalog/study/" class="nav-link router-link-active">Study</a></div><div class="nav-item"><a href="http://www.porcofish.net:1314/" target="_blank" rel="noopener noreferrer" class="nav-link">About</a></div><div class="nav-item"><a href="https://gitee.com/PorcoMar" target="_blank" rel="noopener noreferrer" class="nav-link">Gitee</a></div><div class="nav-item"><a href="https://github.com/PorcoMar?tab=repositories" target="_blank" rel="noopener noreferrer" class="nav-link">Github</a></div><!----></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/catalog/study/" class="nav-link router-link-active">Study</a></div><div class="nav-item"><a href="http://www.porcofish.net:1314/" target="_blank" rel="noopener noreferrer" class="nav-link">About</a></div><div class="nav-item"><a href="https://gitee.com/PorcoMar" target="_blank" rel="noopener noreferrer" class="nav-link">Gitee</a></div><div class="nav-item"><a href="https://github.com/PorcoMar?tab=repositories" target="_blank" rel="noopener noreferrer" class="nav-link">Github</a></div><!----></nav><ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading open"><span>å¼€å‘ç¬”è®°</span><span class="arrow down"></span></p><ul class="sidebar-group-items"><li><a href="/catalog/study/" class="sidebar-link">â¹ studyç›®å½•è¯´æ˜</a></li><li><a href="/catalog/study/vuepressä½¿ç”¨è¯´æ˜.html" class="sidebar-link">â¹ vuePressä½¿ç”¨è¯´æ˜</a></li><li><a href="/catalog/study/å¾®ä¿¡æˆæƒå’ŒsdkåŠ å¯†ç®—æ³•.html" class="sidebar-link">â¹ å¾®ä¿¡æˆæƒå’ŒsdkåŠ å¯†ç®—æ³•</a></li><li><a href="/catalog/study/browserify+gulpè‡ªåŠ¨ç¼–è¯‘æ‰“åŒ….html" class="sidebar-link">â¹ browserify+gulpè‡ªåŠ¨ç¼–è¯‘æ‰“åŒ…</a></li><li><a href="/catalog/study/ä½¿ç”¨webpacké…ç½®MPA.html" class="sidebar-link">â¹ ä½¿ç”¨webpacké…ç½®MPA</a></li><li><a href="/catalog/study/Markdownç¬”è®°.html" class="sidebar-link">â¹ Markdownç¬”è®°</a></li><li><a href="/catalog/study/WePYæ€»ç»“.html" class="active sidebar-link">â¹ WePYæ€»ç»“</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/catalog/study/WePYæ€»ç»“.html#â£-è§£å†³é—®é¢˜ï¼š" class="sidebar-link">â£ è§£å†³é—®é¢˜ï¼š</a></li><li class="sidebar-sub-header"><a href="/catalog/study/WePYæ€»ç»“.html#â£-å®‰è£…ä½¿ç”¨" class="sidebar-link">â£ å®‰è£…ä½¿ç”¨</a></li><li class="sidebar-sub-header"><a href="/catalog/study/WePYæ€»ç»“.html#â£-åŸºæœ¬é…ç½®" class="sidebar-link">â£ åŸºæœ¬é…ç½®</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/catalog/study/WePYæ€»ç»“.html#app-wpy" class="sidebar-link">app.wpy</a></li></ul></li><li class="sidebar-sub-header"><a href="/catalog/study/WePYæ€»ç»“.html#â£-è¯¦ç»†é…ç½®" class="sidebar-link">â£ è¯¦ç»†é…ç½®</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/catalog/study/WePYæ€»ç»“.html#httprequest-js" class="sidebar-link">httpRequest.js</a></li><li class="sidebar-sub-header"><a href="/catalog/study/WePYæ€»ç»“.html#index-wpy" class="sidebar-link">index.wpy</a></li><li class="sidebar-sub-header"><a href="/catalog/study/WePYæ€»ç»“.html#search-wpy" class="sidebar-link">search.wpy</a></li></ul></li><li class="sidebar-sub-header"><a href="/catalog/study/WePYæ€»ç»“.html#â£-æ³¨é‡Šï¼š" class="sidebar-link">â£ æ³¨é‡Šï¼š</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/catalog/study/WePYæ€»ç»“.html#ä»£ç è§„èŒƒï¼š" class="sidebar-link">ä»£ç è§„èŒƒï¼š</a></li></ul></li></ul></li></ul></div></li></ul></div><div class="page"><div class="content"><h1 id="ä»‹ç»"><a href="#ä»‹ç»" aria-hidden="true" class="header-anchor">#</a> ä»‹ç»</h1><p>WePYèµ„æºæ±‡æ€»ï¼š<a href="https://github.com/aben1188/awesome-wepy" target="_blank" rel="noopener noreferrer">â³ awesome-wepy</a></p><div class="danger custom-block"><p class="custom-block-title">Wepy</p><p>WePYæ˜¯ä¸€æ¬¾è®©å°ç¨‹åºæ”¯æŒç»„ä»¶åŒ–å¼€å‘çš„æ¡†æ¶ï¼Œé€šè¿‡é¢„ç¼–è¯‘çš„æ‰‹æ®µè®©å¼€å‘è€…å¯ä»¥é€‰æ‹©è‡ªå·±å–œæ¬¢çš„å¼€å‘é£æ ¼å»å¼€å‘å°ç¨‹åºã€‚æ¡†æ¶çš„ç»†èŠ‚ä¼˜åŒ–ï¼ŒPromiseï¼ŒAsync Functionsçš„å¼•å…¥éƒ½æ˜¯ä¸ºäº†èƒ½è®©å¼€å‘å°ç¨‹åºé¡¹ç›®å˜å¾—æ›´åŠ ç®€å•ï¼Œé«˜æ•ˆã€‚
åŒæ—¶WePYä¹Ÿæ˜¯ä¸€æ¬¾æˆé•¿ä¸­çš„æ¡†æ¶ï¼Œå¤§é‡å¸æ”¶å€Ÿé‰´äº†ä¸€äº›ä¼˜åŒ–å‰ç«¯å·¥å…·ä»¥åŠæ¡†æ¶çš„è®¾è®¡ç†å¿µå’Œæ€æƒ³ã€‚</p></div><h3 id="ç‰¹æ€§ï¼š"><a href="#ç‰¹æ€§ï¼š" aria-hidden="true" class="header-anchor">#</a> ç‰¹æ€§ï¼š</h3><p>ç±»Vueå¼€å‘é£æ ¼
æ”¯æŒè‡ªå®šä¹‰ç»„ä»¶å¼€å‘
æ”¯æŒå¼•å…¥NPMåŒ…
æ”¯æŒPromise
æ”¯æŒES2015+ç‰¹æ€§ï¼Œå¦‚Async Functions
æ”¯æŒå¤šç§ç¼–è¯‘å™¨ï¼ŒLess/Sass/Stylus/PostCSSã€Babel/Typescriptã€Pug
æ”¯æŒå¤šç§æ’ä»¶å¤„ç†ï¼Œæ–‡ä»¶å‹ç¼©ï¼Œå›¾ç‰‡å‹ç¼©ï¼Œå†…å®¹æ›¿æ¢ç­‰
æ”¯æŒ Sourcemapï¼ŒESLintç­‰
å°ç¨‹åºç»†èŠ‚ä¼˜åŒ–ï¼Œå¦‚è¯·æ±‚åˆ—é˜Ÿï¼Œäº‹ä»¶ä¼˜åŒ–ç­‰</p><h2 id="â£-è§£å†³é—®é¢˜ï¼š"><a href="#â£-è§£å†³é—®é¢˜ï¼š" aria-hidden="true" class="header-anchor">#</a> â£ è§£å†³é—®é¢˜ï¼š</h2><h3>å¼€å‘æ¨¡å¼è½¬æ¢ï¼š</h3><ul><li>åœ¨åŸæœ‰çš„å°ç¨‹åºçš„å¼€å‘æ¨¡å¼ä¸‹è¿›è¡Œå†æ¬¡å°è£…ï¼Œæ›´è´´è¿‘äºç°æœ‰MVVMæ¡†æ¶å¼€å‘æ¨¡å¼ã€‚æ¡†æ¶åœ¨å¼€å‘è¿‡ç¨‹ä¸­å‚è€ƒäº†ä¸€äº›ç°åœ¨æ¡†æ¶çš„ä¸€äº›ç‰¹æ€§ï¼Œå¹¶ä¸”èå…¥å…¶ä¸­</li></ul><h3>æ”¯æŒç»„ä»¶åŒ–å¼€å‘ã€‚</h3><h3>æ”¯æŒåŠ è½½å¤–éƒ¨NPMåŒ…ã€‚</h3><h3>å•æ–‡ä»¶æ¨¡å¼ï¼Œä½¿å¾—ç›®å½•ç»“æ„æ›´åŠ æ¸…æ™°ã€‚</h3><ul><li>å®˜æ–¹ç›®å½•ç»“æ„è¦æ±‚appå¿…é¡»æœ‰ä¸‰ä¸ªæ–‡ä»¶app.jsonï¼Œapp.jsï¼Œapp.wxssï¼Œé¡µé¢æœ‰4ä¸ªæ–‡ä»¶ index.jsonï¼Œindex.jsï¼Œindex.wxmlï¼Œindex.wxssã€‚è€Œä¸”æ–‡ä»¶å¿…é¡»åŒåã€‚</li></ul><h3>é»˜è®¤ä½¿ç”¨babelç¼–è¯‘ï¼Œæ”¯æŒES6/7çš„ä¸€äº›æ–°ç‰¹æ€§ã€‚</h3><ul><li><p>ç”¨æˆ·å¯ä»¥é€šè¿‡ä¿®æ”¹wepy.config.js(è€ç‰ˆæœ¬ä½¿ç”¨.wepyrc)é…ç½®æ–‡ä»¶ï¼Œé…ç½®è‡ªå·±ç†Ÿæ‚‰çš„babelç¯å¢ƒè¿›è¡Œå¼€å‘ã€‚é»˜è®¤å¼€å¯ä½¿ç”¨äº†ä¸€äº›æ–°çš„ç‰¹æ€§å¦‚promiseï¼Œasync/awaitç­‰ç­‰ã€‚
</p><h3>é’ˆå¯¹åŸç”ŸAPIè¿›è¡Œä¼˜åŒ–ã€‚</h3><p></p></li><li><p>å¯¹ç°åœ¨APIè¿›è¡Œpromiseå¤„ç†ï¼ŒåŒæ—¶ä¿®å¤ä¸€äº›ç°æœ‰APIçš„ç¼ºé™·ï¼Œæ¯”å¦‚ï¼šwx.requestå¹¶å‘é—®é¢˜ç­‰ã€‚
åŸæœ‰ä»£ç ï¼š</p></li></ul><pre class="language-js"><code><span class="token function-variable function">onLoad</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    wx<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
<span class="highlighted-line">        success<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>            wx<span class="token punctuation">.</span><span class="token function">getUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                success<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>userinfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    self<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>userInfo<span class="token punctuation">:</span> userinfo<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><p>åŸºäºwepyå®ç°ä»£ç ï¼š</p><pre class="language-js"><code><span class="token keyword">async</span> <span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> wx<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>userInfo <span class="token operator">=</span> <span class="token keyword">await</span> wx<span class="token punctuation">.</span><span class="token function">getUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="highlighted-line"><span class="token punctuation">}</span></span></code></pre><p>åœ¨åŒæ—¶å¹¶å‘10ä¸ªrequestè¯·æ±‚æµ‹è¯•æ—¶wepyä¸ä¼šæŠ¥è¯·æ±‚è¿‡å¤š</p><h2 id="â£-å®‰è£…ä½¿ç”¨"><a href="#â£-å®‰è£…ä½¿ç”¨" aria-hidden="true" class="header-anchor">#</a> â£ å®‰è£…ä½¿ç”¨</h2><p>å®‰è£…ï¼ˆæ›´æ–°ï¼‰ wepy å‘½ä»¤è¡Œå·¥å…·ã€‚</p><pre class="language-js"><code>npm install wepy<span class="token operator">-</span>cli <span class="token operator">-</span>g
</code></pre><p>ç”Ÿæˆå¼€å‘ç¤ºä¾‹</p><pre class="language-js"><code>wepy init standard myproject
</code></pre><p>å®‰è£…ä¾èµ–</p><pre class="language-js"><code>cd myproject
npm install
</code></pre><p>å¼€å‘å®æ—¶ç¼–è¯‘</p><pre class="language-js"><code>wepy build <span class="token operator">--</span>watch
</code></pre><p>å¼€å‘è€…å·¥å…·å¯¼å…¥é¡¹ç›®</p><p>ä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·æ–°å»ºé¡¹ç›®ï¼Œæœ¬åœ°å¼€å‘é€‰æ‹©é¡¹ç›®æ ¹ç›®å½•ï¼Œä¼šè‡ªåŠ¨å¯¼å…¥é¡¹ç›®é…ç½®ã€‚</p><h2 id="â£-åŸºæœ¬é…ç½®"><a href="#â£-åŸºæœ¬é…ç½®" aria-hidden="true" class="header-anchor">#</a> â£ åŸºæœ¬é…ç½®</h2><ul><li>é¡¹ç›®ç›®å½•ç»“æ„</li></ul><pre class="language-js"><code>dist
node_modules
src
<span class="highlighted-line">    components</span>        com_a<span class="token punctuation">.</span>wpy
        com_b<span class="token punctuation">.</span>wpy
    pages
        index<span class="token punctuation">.</span>wpy
        page2<span class="token punctuation">.</span>wpy
    app<span class="token punctuation">.</span>wpy
<span class="token keyword">package</span><span class="token punctuation">.</span>json
</code></pre><ul><li>/src/config/index.js</li></ul><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">CONFIG</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">VERSION</span><span class="token punctuation">:</span> <span class="token string">'1.0.0'</span><span class="token punctuation">,</span>  <span class="token comment">//* ç‰ˆæœ¬å·</span>
  <span class="token constant">TEST_API_URL</span><span class="token punctuation">:</span> <span class="token string">'https://ssl.xxxxx.com_test'</span><span class="token punctuation">,</span>  <span class="token comment">//* æµ‹è¯•ç¯å¢ƒ</span>
<span class="highlighted-line">  <span class="token constant">YUFA_API_URL</span><span class="token punctuation">:</span> <span class="token string">'https://ssl.xxxx.com/xcxapi_yufa'</span><span class="token punctuation">,</span> <span class="token comment">//* é¢„å‘ç¯å¢ƒ</span></span>  <span class="token constant">PROD_API_URL</span><span class="token punctuation">:</span> <span class="token string">'https://ssl.xxxx.com/xcxapi_online'</span><span class="token punctuation">,</span> <span class="token comment">//* æ­£å¼ç¯å¢ƒ</span>
  <span class="token constant">ENV</span><span class="token punctuation">:</span> <span class="token string">'DEV'</span><span class="token punctuation">,</span> <span class="token comment">//* DEV--æµ‹è¯• PRE--è¯­æ³• PROD--æ­£å¼</span>
  <span class="token constant">STORAGE_PREFIX</span><span class="token punctuation">:</span> <span class="token string">&quot;YIZHEN__YUESAO__&quot;</span><span class="token punctuation">,</span> <span class="token comment">//* LocalStorageå‰ç¼€</span>
  <span class="token constant">USER</span><span class="token punctuation">:</span> <span class="token string">'TEST'</span><span class="token punctuation">,</span> <span class="token comment">// * DEV -- å¼€å‘è€… TEST -- æµ‹è¯•  USER -- ç”¨æˆ·</span>
<span class="token punctuation">}</span>
</code></pre><ul><li>/src/style/common.css</li></ul><pre class="language-js"><code>$color<span class="token punctuation">:</span> #<span class="token number">4</span>f4f4f<span class="token punctuation">;</span>
</code></pre><h3 id="app-wpy"><a href="#app-wpy" aria-hidden="true" class="header-anchor">#</a> app.wpy</h3><ul><li>/src/app.wpy</li></ul><pre class="language-js"><code><span class="token operator">&lt;</span>style type<span class="token operator">=</span><span class="token string">&quot;less&quot;</span><span class="token operator">&gt;</span>
  @<span class="token keyword">import</span> <span class="token string">'./styles/common.less'</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
<span class="highlighted-line"></span><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">import</span> wepy <span class="token keyword">from</span> <span class="token string">'wepy'</span>
<span class="token keyword">import</span> <span class="token string">'wepy-async-function'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">CONFIG</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./config'</span>

<span class="token keyword">var</span> <span class="token constant">APIURL</span>
<span class="token keyword">let</span> <span class="token constant">VERSION</span> <span class="token operator">=</span> <span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">VERSION</span>
<span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">ENV</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">case</span> <span class="token string">'DEV'</span><span class="token punctuation">:</span>
    <span class="token constant">APIURL</span> <span class="token operator">=</span> <span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">TEST_API_URL</span>
    <span class="token keyword">break</span>
  <span class="token keyword">case</span> <span class="token string">'PRE'</span><span class="token punctuation">:</span>
    <span class="token constant">APIURL</span> <span class="token operator">=</span> <span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">YUFA_API_URL</span>
    <span class="token keyword">break</span>
  <span class="token keyword">case</span> <span class="token string">'PROD'</span><span class="token punctuation">:</span>
    <span class="token constant">APIURL</span> <span class="token operator">=</span> <span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">PROD_API_URL</span>
    <span class="token keyword">break</span>
  <span class="token keyword">default</span><span class="token punctuation">:</span>
    <span class="token constant">APIURL</span> <span class="token operator">=</span> <span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">PROD_API_URL</span>
    <span class="token keyword">break</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> wepy<span class="token punctuation">.</span>app <span class="token punctuation">{</span>
  config <span class="token operator">=</span> <span class="token punctuation">{</span>
    pages<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token string">'pages/my/index'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    window<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      backgroundTextStyle<span class="token punctuation">:</span> <span class="token string">'light'</span><span class="token punctuation">,</span>
      navigationBarBackgroundColor<span class="token punctuation">:</span> <span class="token string">'#fd5a5f'</span><span class="token punctuation">,</span>
      navigationBarTitleText<span class="token punctuation">:</span> <span class="token string">'WeChat'</span><span class="token punctuation">,</span>
      navigationBarTextStyle<span class="token punctuation">:</span> <span class="token string">'#ffffff'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    tabBar<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      borderStyle<span class="token punctuation">:</span> <span class="token string">'black'</span><span class="token punctuation">,</span>
      selectedColor<span class="token punctuation">:</span> <span class="token string">'#fd5a5f'</span><span class="token punctuation">,</span>
      list<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          pagePath<span class="token punctuation">:</span> <span class="token string">'pages/my/index'</span><span class="token punctuation">,</span>
          text<span class="token punctuation">:</span> <span class="token string">'æˆ‘çš„'</span><span class="token punctuation">,</span>
          iconPath<span class="token punctuation">:</span> <span class="token string">'images/tabBar/my@2x.png'</span><span class="token punctuation">,</span>
          selectedIconPath<span class="token punctuation">:</span> <span class="token string">'images/tabBar/my@2x-z.png'</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  globalData <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token constant">APIURL</span><span class="token punctuation">:</span> <span class="token constant">APIURL</span><span class="token punctuation">,</span>
    <span class="token constant">HEADER</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'application/x-www-form-urlencoded'</span><span class="token punctuation">,</span>
      <span class="token string">'xcx-version'</span><span class="token punctuation">:</span> <span class="token constant">VERSION</span><span class="token punctuation">,</span>
      <span class="token string">'xcx-name'</span><span class="token punctuation">:</span> <span class="token string">'admin'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    role<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    user<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    openId<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    unionId<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    userinfo_wx<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    session_key<span class="token punctuation">:</span> <span class="token keyword">null</span>
  <span class="token punctuation">}</span>

  <span class="token function">constructor</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'requestfix'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">onLaunch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å°ç¨‹åºç‰ˆæœ¬å·: '</span><span class="token punctuation">,</span> <span class="token constant">VERSION</span><span class="token punctuation">,</span> <span class="token string">'è¯·æ±‚æ¥å£åœ°å€: '</span><span class="token punctuation">,</span> <span class="token constant">APIURL</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><h2 id="â£-è¯¦ç»†é…ç½®"><a href="#â£-è¯¦ç»†é…ç½®" aria-hidden="true" class="header-anchor">#</a> â£ è¯¦ç»†é…ç½®</h2><h3 id="httprequest-js"><a href="#httprequest-js" aria-hidden="true" class="header-anchor">#</a> httpRequest.js</h3><ul><li>æˆ‘ä»¬å…ˆå†™ä¸€ä¸ªåŸºäºPromiseçš„requestè¯·æ±‚</li><li>/src/utils/httpRequest.js</li></ul><pre class="language-js"><code><span class="token keyword">import</span> wepy <span class="token keyword">from</span> <span class="token string">'wepy'</span>
<span class="token keyword">import</span> <span class="token string">'wepy-async-function'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">CONFIG</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../config'</span>
<span class="highlighted-line"><span class="token keyword">import</span> Storage <span class="token keyword">from</span> <span class="token string">'./Storage'</span></span>
<span class="token comment">// æ¥å£</span>
<span class="token keyword">var</span> <span class="token constant">APIURL</span>
<span class="token keyword">let</span> <span class="token constant">VERSION</span> <span class="token operator">=</span> <span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">VERSION</span>
<span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">ENV</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">case</span> <span class="token string">'DEV'</span><span class="token punctuation">:</span>
    <span class="token constant">APIURL</span> <span class="token operator">=</span> <span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">TEST_API_URL</span>
    <span class="token keyword">break</span>
  <span class="token keyword">case</span> <span class="token string">'PRE'</span><span class="token punctuation">:</span>
    <span class="token constant">APIURL</span> <span class="token operator">=</span> <span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">YUFA_API_URL</span>
    <span class="token keyword">break</span>
  <span class="token keyword">case</span> <span class="token string">'PROD'</span><span class="token punctuation">:</span>
    <span class="token constant">APIURL</span> <span class="token operator">=</span> <span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">PROD_API_URL</span>
    <span class="token keyword">break</span>
  <span class="token keyword">default</span><span class="token punctuation">:</span>
    <span class="token constant">APIURL</span> <span class="token operator">=</span> <span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">PROD_API_URL</span>
    <span class="token keyword">break</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * è·å–æ•°æ®
 *
 * @param {String} context ä¸Šä¸‹æ–‡
 * @param {String} api æ¥å£åœ°å€
 * @param {Object} data è¯·æ±‚æ•°æ®
 * @param {Boolean} needLogin æ˜¯å¦éœ€è¦ç™»å½•
 * @param {Boolean} isShare æ˜¯å¦æ˜¯åˆ†äº«é¡µ
 */</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">httpRequest</span> <span class="token operator">=</span> <span class="token punctuation">(</span>globalData<span class="token punctuation">,</span> api<span class="token punctuation">,</span> data<span class="token punctuation">,</span> needLogin <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span> isShare <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">USER</span> <span class="token operator">===</span> <span class="token string">'DEV'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    globalData<span class="token punctuation">.</span><span class="token constant">HEADER</span><span class="token punctuation">.</span>staffuid <span class="token operator">=</span> <span class="token number">4</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// éœ€è¦ç™»å½•çš„æ¥å£</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>needLogin <span class="token operator">&amp;&amp;</span> <span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">USER</span> <span class="token operator">!==</span> <span class="token string">'DEV'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>globalData<span class="token punctuation">.</span><span class="token constant">HEADER</span><span class="token punctuation">.</span>staffuid<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> storage <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Storage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      storage<span class="token punctuation">.</span><span class="token function">removeValueFromStorage</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">STORAGE_PREFIX</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">USER`</span></span><span class="token punctuation">)</span>
      storage<span class="token punctuation">.</span><span class="token function">removeValueFromStorage</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">STORAGE_PREFIX</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">ROLE`</span></span><span class="token punctuation">)</span>
      storage<span class="token punctuation">.</span><span class="token function">removeValueFromStorage</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">STORAGE_PREFIX</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">STAFFUID`</span></span><span class="token punctuation">)</span>
      <span class="token keyword">delete</span> globalData<span class="token punctuation">.</span><span class="token constant">HEADER</span><span class="token punctuation">.</span>staffuid
      globalData<span class="token punctuation">.</span><span class="token constant">HEADER</span> <span class="token operator">=</span>  <span class="token punctuation">{</span>
        <span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'application/x-www-form-urlencoded'</span><span class="token punctuation">,</span>
        <span class="token string">'xcx-version'</span><span class="token punctuation">:</span> <span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">VERSION</span><span class="token punctuation">,</span>
        <span class="token string">'xcx-name'</span><span class="token punctuation">:</span> <span class="token string">'admin'</span>
      <span class="token punctuation">}</span>

      wepy<span class="token punctuation">.</span><span class="token function">redirectTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token punctuation">:</span> <span class="token string">'/pages/my/login'</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>

      <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  wepy<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    title<span class="token punctuation">:</span> <span class="token string">'åŠ è½½ä¸­...'</span><span class="token punctuation">,</span>
    icon<span class="token punctuation">:</span> <span class="token string">'loading'</span><span class="token punctuation">,</span>
    duration<span class="token punctuation">:</span> <span class="token number">100000</span><span class="token punctuation">,</span>
    mask<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    wepy<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      url<span class="token punctuation">:</span> <span class="token constant">APIURL</span> <span class="token operator">+</span> api<span class="token punctuation">,</span>
      method<span class="token punctuation">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span>
      header<span class="token punctuation">:</span> globalData<span class="token punctuation">.</span><span class="token constant">HEADER</span><span class="token punctuation">,</span>
      data<span class="token punctuation">:</span> data<span class="token punctuation">,</span>
      success<span class="token punctuation">:</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'è¯·æ±‚æˆåŠŸ'</span><span class="token punctuation">,</span> api<span class="token punctuation">,</span> data<span class="token punctuation">,</span> res<span class="token punctuation">)</span>
        wepy<span class="token punctuation">.</span><span class="token function">hideToast</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      fail<span class="token punctuation">:</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        wx<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          icon<span class="token punctuation">:</span> <span class="token string">'loading'</span><span class="token punctuation">,</span>
          title<span class="token punctuation">:</span> <span class="token string">'è¯·æ£€æŸ¥ç½‘ç»œ'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre><h3 id="index-wpy"><a href="#index-wpy" aria-hidden="true" class="header-anchor">#</a> index.wpy</h3><ul><li>/src/pages/my/index.wpy ä¸šåŠ¡é¡µé¢ä¸­éœ€è¦å¼•ç”¨çš„æ—¢å¯ä»¥ä½¿ç”¨AMDæ–¹å¼ä¹Ÿå¯ä»¥ä½¿ç”¨CMDæ–¹å¼
è¿™é‡Œæˆ‘ä»¬å¼•ç”¨äº†ä¸€ä¸ªæœç´¢ç»„ä»¶search.wpy,æ¥ä¸‹æ¥ä¼šå±•ç¤ºè¯¥ç»„ä»¶çš„å†™æ³•</li></ul><pre class="language-js"><code><span class="token operator">&lt;</span>style<span class="token operator">&gt;</span>
<span class="token punctuation">.</span><span class="token function">flex</span><span class="token punctuation">(</span>@align<span class="token punctuation">:</span> flex<span class="token operator">-</span>start<span class="token punctuation">,</span> @just<span class="token punctuation">:</span> flex<span class="token operator">-</span>start<span class="token punctuation">,</span> @dirction<span class="token punctuation">:</span> row<span class="token punctuation">)</span><span class="token punctuation">{</span>
  display<span class="token punctuation">:</span>flex<span class="token punctuation">;</span>
<span class="highlighted-line">  justify<span class="token operator">-</span>content<span class="token punctuation">:</span> @just<span class="token punctuation">;</span></span>  align<span class="token operator">-</span>items<span class="token punctuation">:</span> @align<span class="token punctuation">;</span>
  flex<span class="token operator">-</span>direction<span class="token punctuation">:</span>@dirction<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span>searchComponent<span class="token punctuation">{</span>
  position<span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
  top<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">import</span> wepy <span class="token keyword">from</span> <span class="token string">'wepy'</span>
<span class="token keyword">import</span> Search <span class="token keyword">from</span> <span class="token string">'../../components/common/Search'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">index</span> <span class="token keyword">extends</span> <span class="token class-name">wepy<span class="token punctuation">.</span>page</span> <span class="token punctuation">{</span>
config <span class="token operator">=</span> <span class="token punctuation">{</span>
    navigationBarTitleText<span class="token punctuation">:</span> <span class="token string">'index'</span><span class="token punctuation">,</span>
    enablePullDownRefresh<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    navigationBarBackgroundColor<span class="token punctuation">:</span> <span class="token string">'#fd5a5f'</span><span class="token punctuation">,</span>
    navigationBarTextStyle<span class="token punctuation">:</span> <span class="token string">'#fff'</span>
  <span class="token punctuation">}</span>
  data <span class="token operator">=</span> <span class="token punctuation">{</span>
    num<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
  <span class="token function">onLoad</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span>
  <span class="token function">onShow</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span>
  components <span class="token operator">=</span> <span class="token punctuation">{</span>
    search<span class="token punctuation">:</span> Search<span class="token punctuation">,</span>
    loadMore<span class="token punctuation">:</span> LoadMore
  <span class="token punctuation">}</span>
  events <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'search-keywords'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>cpName<span class="token punctuation">,</span> keywords<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>cpName<span class="token punctuation">,</span> keywords<span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>pageNo <span class="token operator">=</span> <span class="token number">1</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>requestStatus <span class="token operator">=</span> <span class="token boolean">true</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>loadMore<span class="token punctuation">.</span>showLoading <span class="token operator">=</span> <span class="token boolean">true</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>loadMore<span class="token punctuation">.</span>tip <span class="token operator">=</span> <span class="token string">''</span>
      <span class="token keyword">let</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>pageNo<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pageNo<span class="token punctuation">,</span> pageSize<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>pageSize<span class="token punctuation">,</span> type<span class="token punctuation">:</span> <span class="token string">'YUESAO'</span><span class="token punctuation">,</span> keyword<span class="token punctuation">:</span> keywords<span class="token punctuation">}</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>keywords <span class="token operator">=</span> keywords
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$apply</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">requestList</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>search <span class="token punctuation">:</span>placeholder<span class="token operator">=</span><span class="token string">&quot;placeholder&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;searchComponent&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>search<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

</code></pre><h3 id="search-wpy"><a href="#search-wpy" aria-hidden="true" class="header-anchor">#</a> search.wpy</h3><ul><li>è¿™é‡Œæˆ‘ä»¬å°†å±•ç¤ºsearchç»„ä»¶çš„å†™æ³•ï¼Œä»¥ä¸‹å°±æ˜¯å…·ä½“ä»£ç </li><li>/src/commponent/common/search.wpy</li></ul><pre class="language-js"><code><span class="token operator">&lt;</span>style lang<span class="token operator">=</span><span class="token string">&quot;less&quot;</span><span class="token operator">&gt;</span>
<span class="token punctuation">.</span>Search<span class="token operator">--</span>Wrapper <span class="token punctuation">{</span>
  height<span class="token punctuation">:</span> <span class="token number">81</span>rpx<span class="token punctuation">;</span>
<span class="highlighted-line">  width<span class="token punctuation">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span></span>  background<span class="token punctuation">:</span> #fd5a5f<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>Search<span class="token operator">--</span>Box__Input <span class="token punctuation">{</span>
  height<span class="token punctuation">:</span> <span class="token number">65</span>rpx<span class="token punctuation">;</span>
  width<span class="token punctuation">:</span> <span class="token number">696</span>rpx<span class="token punctuation">;</span>
  margin<span class="token punctuation">:</span> <span class="token number">0</span> auto<span class="token punctuation">;</span>
  position<span class="token punctuation">:</span> relative<span class="token punctuation">;</span>

  image <span class="token punctuation">{</span>
    height<span class="token punctuation">:</span> <span class="token number">28</span>rpx<span class="token punctuation">;</span>
    width<span class="token punctuation">:</span> <span class="token number">26</span>rpx<span class="token punctuation">;</span>
    position<span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
    top<span class="token punctuation">:</span> <span class="token number">15</span>rpx<span class="token punctuation">;</span>
    left<span class="token punctuation">:</span> <span class="token number">164</span>rpx<span class="token punctuation">;</span>
    z<span class="token operator">-</span>index<span class="token punctuation">:</span> <span class="token number">999</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  input <span class="token punctuation">{</span>
    box<span class="token operator">-</span>sizing<span class="token punctuation">:</span> border<span class="token operator">-</span>box<span class="token punctuation">;</span>
    height<span class="token punctuation">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
    width<span class="token punctuation">:</span> <span class="token number">100</span><span class="token operator">%</span><span class="token punctuation">;</span>
    border<span class="token operator">-</span>radius<span class="token punctuation">:</span> <span class="token number">33</span>rpx<span class="token punctuation">;</span><span class="token punctuation">;</span>
    background<span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
    font<span class="token operator">-</span>size<span class="token punctuation">:</span> <span class="token number">24</span>rpx<span class="token punctuation">;</span>
    padding<span class="token operator">-</span>left<span class="token punctuation">:</span> <span class="token number">24</span>rpx<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token punctuation">.</span>Search<span class="token operator">--</span>Input__Placeholder <span class="token punctuation">{</span>
  box<span class="token operator">-</span>sizing<span class="token punctuation">:</span> border<span class="token operator">-</span>box<span class="token punctuation">;</span>
  color<span class="token punctuation">:</span> #<span class="token number">999999</span><span class="token punctuation">;</span>
  font<span class="token operator">-</span>size<span class="token punctuation">:</span> <span class="token number">24</span>rpx<span class="token punctuation">;</span>
  padding<span class="token operator">-</span>left<span class="token punctuation">:</span> <span class="token number">180</span>rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;Search--Wrapper&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;Search--Box__Input&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">&quot;/images/components/search/search.png&quot;</span> wx<span class="token punctuation">:</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;{{searchImg}}&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>input placeholder<span class="token operator">=</span><span class="token string">&quot;{{placeholder}}&quot;</span> value<span class="token operator">=</span><span class="token string">&quot;{{value}}&quot;</span> placeholder<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;Search--Input__Placeholder&quot;</span> confirm<span class="token operator">-</span>type<span class="token operator">=</span><span class="token string">&quot;search&quot;</span> @focus<span class="token operator">=</span><span class="token string">&quot;focus&quot;</span> @blur<span class="token operator">=</span><span class="token string">&quot;blur&quot;</span> @input<span class="token operator">=</span><span class="token string">&quot;input&quot;</span> @confirm<span class="token operator">=</span><span class="token string">&quot;search({{keywords}})&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">import</span> wepy <span class="token keyword">from</span> <span class="token string">'wepy'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Search</span> <span class="token keyword">extends</span> <span class="token class-name">wepy<span class="token punctuation">.</span>component</span> <span class="token punctuation">{</span>
  props <span class="token operator">=</span> <span class="token punctuation">{</span>
    placeholder<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    value<span class="token punctuation">:</span> String
  <span class="token punctuation">}</span>

  data <span class="token operator">=</span> <span class="token punctuation">{</span>
    keywords<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    searchImg<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
  methods <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function">input</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>keywords <span class="token operator">=</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>value
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'search-input'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$name<span class="token punctuation">,</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">search</span><span class="token punctuation">(</span>keywords<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'search-keywords'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$name<span class="token punctuation">,</span> keywords<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'search-close'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$name<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>searchImg <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">blur</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>keywords<span class="token punctuation">.</span>length <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">.</span>searchImg <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>searchImg <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>


</code></pre><h2 id="â£-æ³¨é‡Šï¼š"><a href="#â£-æ³¨é‡Šï¼š" aria-hidden="true" class="header-anchor">#</a> â£ æ³¨é‡Šï¼š</h2><ul><li><p>åŸºäºwepyçš„å°ç¨‹åºå†™æ³•å¤§å¤šèåˆå’Œvue,ç»“åˆå°ç¨‹åºè‡ªèº«çš„apiã€‚å†™æ³•ä¸Šç‰¹åˆ«ä¸¥æ ¼ï¼Œä¸€ä¸ªå¤šä½™çš„ç©ºæ ¼éƒ½ä¸å…è®¸ï¼Œéœ€è¦å¤šæ³¨æ„ã€‚</p></li><li><p>åœ¨pagesçš„æœ€åä¸€è¡Œéœ€è¦ç•™å‡ºï¼Œä¸ç„¶ä¼šæŠ¥é”™</p></li><li><p>ä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·æ–°å»ºé¡¹ç›®ï¼Œæœ¬åœ°å¼€å‘é€‰æ‹©distç›®å½•ã€‚</p></li><li><p>å¾®ä¿¡å¼€å‘è€…å·¥å…· --&gt; é¡¹ç›® --&gt; å…³é—­ES6è½¬ES5ã€‚</p></li><li><p>æœ¬åœ°é¡¹ç›®æ ¹ç›®å½•è¿è¡Œwepy build --watchï¼Œå¼€å¯å®æ—¶ç¼–è¯‘ã€‚æ•ˆæœå¦‚ä¸‹å›¾ï¼š</p></li></ul><img src="https://cloud.githubusercontent.com/assets/2182004/20554645/482b0f64-b198-11e6-8d4e-70c92326004f.png"><h3 id="ä»£ç è§„èŒƒï¼š"><a href="#ä»£ç è§„èŒƒï¼š" aria-hidden="true" class="header-anchor">#</a> ä»£ç è§„èŒƒï¼š</h3><ul><li>å˜é‡ä¸æ–¹æ³•ä½¿ç”¨å°½é‡ä½¿ç”¨é©¼å³°å¼å‘½åï¼Œé¿å…ä½¿ç”¨$å¼€å¤´ã€‚ ä»¥$å¼€å¤´çš„æ–¹æ³•æˆ–è€…å±æ€§ä¸ºæ¡†æ¶å†…å»ºæ–¹æ³•æˆ–è€…å±æ€§ï¼Œå¯ä»¥è¢«ä½¿ç”¨ï¼Œä½¿ç”¨å‰è¯·å‚è€ƒAPIæ–‡æ¡£ã€‚
å…¥å£ï¼Œé¡µé¢ï¼Œç»„ä»¶çš„å‘½ååç¼€ä¸º.wpyã€‚å¤–é“¾çš„æ–‡ä»¶å¯ä»¥æ˜¯å…¶å®ƒåç¼€ã€‚ è¯·å‚è€ƒwpyæ–‡ä»¶è¯´æ˜
ä½¿ç”¨ES6è¯­æ³•å¼€å‘ã€‚ æ¡†æ¶åœ¨ES6ä¸‹å¼€å‘ï¼Œå› æ­¤ä¹Ÿéœ€è¦ä½¿ç”¨ES6å¼€å‘å°ç¨‹åºï¼ŒES6ä¸­æœ‰å¤§é‡çš„è¯­æ³•ç³–å¯ä»¥è®©æˆ‘ä»¬çš„ä»£ç æ›´åŠ ç®€æ´é«˜æ•ˆã€‚
ä½¿ç”¨Promise æ¡†æ¶é»˜è®¤å¯¹å°ç¨‹åºæä¾›çš„APIå…¨éƒ½è¿›è¡Œäº† Promise å¤„ç†ï¼Œç”šè‡³å¯ä»¥ç›´æ¥ä½¿ç”¨async/awaitç­‰æ–°ç‰¹æ€§è¿›è¡Œå¼€å‘ã€‚</li></ul></div><!----><div class="content page-nav"><p class="inner"><span class="prev">
        â† <a href="/catalog/study/Markdownç¬”è®°.html" class="prev">
          â¹ Markdownç¬”è®°
        </a></span><!----></p></div></div></div></div>
    <script src="/assets/js/5.64c07d37.js" defer></script><script src="/assets/js/app.1a1b49cb.js" defer></script>
  </body>
</html>
