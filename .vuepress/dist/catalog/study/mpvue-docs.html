<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PorcoMar Site | ➹ mpvue-docs</title>
    <meta name="description" content="Settle 🍀DUO in a golden house~👺">
    <link rel="shortcut icon" type="image/x-icon" href="https://gitee.com/uploads/6/1023506_PorcoMar.png?1500276509&quot; rel=&quot;shortcut icon">
    
    <link rel="preload" href="/assets/css/15.styles.7cddef4a.css" as="style"><link rel="preload" href="/assets/js/app.5f6376b3.js" as="script"><link rel="preload" href="/assets/js/7.c2b6ae81.js" as="script"><link rel="prefetch" href="/assets/js/0.85ea7835.js"><link rel="prefetch" href="/assets/js/1.1530118e.js"><link rel="prefetch" href="/assets/js/2.bfbd795d.js"><link rel="prefetch" href="/assets/js/3.6b624594.js"><link rel="prefetch" href="/assets/js/4.cf1e7f06.js"><link rel="prefetch" href="/assets/js/5.d592c203.js"><link rel="prefetch" href="/assets/js/6.e74f166f.js"><link rel="prefetch" href="/assets/js/8.706825be.js"><link rel="prefetch" href="/assets/js/9.1ddc9aaa.js"><link rel="prefetch" href="/assets/js/10.400ba2c7.js"><link rel="prefetch" href="/assets/js/11.91a8abcc.js"><link rel="prefetch" href="/assets/js/12.d9ad7544.js"><link rel="prefetch" href="/assets/js/13.e30c9632.js"><link rel="prefetch" href="/assets/js/14.66ea01bd.js">
    <link rel="stylesheet" href="/assets/css/15.styles.7cddef4a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      PorcoMar Site
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/catalog/study/" class="nav-link router-link-active">Study</a></div><div class="nav-item"><a href="http://www.porcofish.net:1314/" target="_blank" rel="noopener noreferrer" class="nav-link">About</a></div><div class="nav-item"><a href="https://gitee.com/PorcoMar" target="_blank" rel="noopener noreferrer" class="nav-link">Gitee</a></div><div class="nav-item"><a href="https://github.com/PorcoMar?tab=repositories" target="_blank" rel="noopener noreferrer" class="nav-link">Github</a></div><!----></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/catalog/study/" class="nav-link router-link-active">Study</a></div><div class="nav-item"><a href="http://www.porcofish.net:1314/" target="_blank" rel="noopener noreferrer" class="nav-link">About</a></div><div class="nav-item"><a href="https://gitee.com/PorcoMar" target="_blank" rel="noopener noreferrer" class="nav-link">Gitee</a></div><div class="nav-item"><a href="https://github.com/PorcoMar?tab=repositories" target="_blank" rel="noopener noreferrer" class="nav-link">Github</a></div><!----></nav><ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading open"><span>开发笔记</span><span class="arrow down"></span></p><ul class="sidebar-group-items"><li><a href="/catalog/study/" class="sidebar-link">➹ study目录说明</a></li><li><a href="/catalog/study/vuepress使用说明.html" class="sidebar-link">➹ vuePress使用说明</a></li><li><a href="/catalog/study/微信授权和sdk加密算法.html" class="sidebar-link">➹ 微信授权和sdk加密算法</a></li><li><a href="/catalog/study/browserify+gulp自动编译打包.html" class="sidebar-link">➹ browserify+gulp自动编译打包</a></li><li><a href="/catalog/study/使用webpack配置MPA.html" class="sidebar-link">➹ 使用webpack配置MPA</a></li><li><a href="/catalog/study/Markdown笔记.html" class="sidebar-link">➹ Markdown笔记</a></li><li><a href="/catalog/study/vuex的理解.html" class="sidebar-link">➹ vuex的理解</a></li><li><a href="/catalog/study/WePY总结.html" class="sidebar-link">➹ WePY总结</a></li><li><a href="/catalog/study/mpvue-docs.html" class="active sidebar-link">➹ mpvue-docs</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/catalog/study/mpvue-docs.html#➣-介绍：" class="sidebar-link">➣ 介绍：</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/catalog/study/mpvue-docs.html#安装" class="sidebar-link">安装</a></li></ul></li><li class="sidebar-sub-header"><a href="/catalog/study/mpvue-docs.html#➣-注意点" class="sidebar-link">➣ 注意点</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/catalog/study/mpvue-docs.html#组件部分" class="sidebar-link">组件部分</a></li><li class="sidebar-sub-header"><a href="/catalog/study/mpvue-docs.html#优化建议：" class="sidebar-link">优化建议：</a></li><li class="sidebar-sub-header"><a href="/catalog/study/mpvue-docs.html#常见问题：" class="sidebar-link">常见问题：</a></li></ul></li></ul></li><li><a href="/catalog/study/一些常用的Linux远程操作命令记录.html" class="sidebar-link">➹ 一些常用的 Linux 远程操作命令记录</a></li><li><a href="/catalog/study/使用PM2管理Node服务.html" class="sidebar-link">➹ 使用 PM2 管理 Node 服务</a></li><li><a href="/catalog/study/yarn和npm的比较.html" class="sidebar-link">➹ yarn和npm的比较</a></li></ul></div></li></ul></div><div class="page"><div class="content"><h2 id="➣-介绍："><a href="#➣-介绍：" aria-hidden="true" class="header-anchor">#</a> ➣ 介绍：</h2><div class="tip custom-block"><p class="custom-block-title">Vue.js in mini program</p><p>mpvue （github 地址请参见）是一个使用 Vue.js 开发小程序的前端框架。框架基于 Vue.js 核心，mpvue 修改了 Vue.js 的 runtime 和 compiler 实现，使其可以运行在小程序环境中，从而为小程序开发引入了整套 Vue.js 开发体验。值得一提的是<a href="http://mpvue.com/mpvue/#_2" target="_blank" rel="noopener noreferrer">mpvue的说明文档</a>也是用的vuepress</p></div><h3>主要特性</h3><p>使用 mpvue 开发小程序，你将在小程序技术体系的基础上获取到这样一些能力：</p><ul><li>彻底的组件化开发能力：提高代码复用性</li><li>完整的 Vue.js 开发体验</li><li>方便的 Vuex 数据管理方案：方便构建复杂应用</li><li>快捷的 webpack 构建机制：自定义构建策略、开发阶段 hotReload</li><li>支持使用 npm 外部依赖</li><li>使用 Vue.js 命令行工具 vue-cli 快速初始化项目</li><li>H5 代码转换编译成小程序目标代码的能力</li></ul><h3>配套设施</h3><p>mpvue 作为小程序版本的 Vue.js，在框架 SDK 之外，完整的技术体系还包括如下设施。</p><ul><li>mpvue-loader 提供 webpack 版本的加载器</li><li>mpvue-webpack-target webpack 构建目标</li><li>postcss-mpvue-wxss 样式代码转换预处理工具</li><li>px2rpx-loader 样式转化插件</li><li>其它</li></ul><h3 id="安装"><a href="#安装" aria-hidden="true" class="header-anchor">#</a> 安装</h3><p>mpvue 保留了 vue.runtime 核心方法，无缝继承了 Vue.js 的基础能力,mpvue-template-compiler还提供了将 vue 的模板语法转换到小程序的 wxml 语法的能力，修改了 vue 的建构配置，使之构建出符合小程序项目结构的代码格式： json/wxml/wxss/js 文件</p><p>通过 Vue.js 命令行工具 vue-cli，你只需在终端窗口输入几条简单命令，即可快速创建和启动一个带热重载、保存时静态检查、内置代码构建功能的小程序项目：</p><pre class="language-js"><code># 全局安装 vue<span class="token operator">-</span>cli
$ npm install <span class="token operator">--</span>global vue<span class="token operator">-</span>cli
</code></pre><ul><li>创建一个基于 mpvue-quickstart 模板的新项目</li></ul><pre class="language-js"><code>$ vue init mpvue<span class="token operator">/</span>mpvue<span class="token operator">-</span>quickstart my<span class="token operator">-</span>project
</code></pre><ul><li>安装依赖</li></ul><pre class="language-js"><code>$ cd my<span class="token operator">-</span>project
$ npm install
</code></pre><ul><li>启动构建</li></ul><pre class="language-js"><code>$ npm run dev
</code></pre><p>接下来，你需要启动微信开发者工具，打开dist文件即可创建第一个小程序，如图所示：
<img src="/assets/img/show.5da5ac96.jpg"></p><h2 id="➣-注意点"><a href="#➣-注意点" aria-hidden="true" class="header-anchor">#</a> ➣ 注意点</h2><ul><li>不要在选项属性或回调上使用箭头函数，比如 created: () =&gt; console.log(this.a) 或 vm.$watch('a', newValue =&gt; this.myMethod())。因为箭头函数是和父级上下文绑定在一起的，this 不会是如你做预期的 Vue 实例，且 this.a 或 this.myMethod 也会是未定义的。</li></ul><hr><ul><li>微信小程序的页面的 query 参数是通过 onLoad(options) 获取的，mpvue 对此进行了优化，直接通过 this.$root.$mp.query 获取相应的参数数据，其调用需要在 onLoad 生命周期触发之后使用，比如 onShow 等。</li></ul><hr><ul><li>不支持 纯-HTML
小程序里所有的 BOM／DOM 都不能用，也就是说 v-html 指令不能用。</li></ul><hr><ul><li>不支持部分复杂的 JavaScript 渲染表达式
我们会把 template 中的 {{}} 双花括号的部分，直接编码到 wxml 文件中，由于微信小程序的能力限制(数据绑定)，所以无法支持复杂的 JavaScript 表达式。</li></ul><p>目前可以使用的有<code> + - * % ?: ! == === &gt; &lt; [] .，</code>剩下的还待完善。</p><pre class="language-js"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 这种就不支持，建议写 computed <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> message<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
</code></pre><pre class="language-js"><code><span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>li v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;item in list&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div @click<span class="token operator">=</span><span class="token string">&quot;clickHandle(item, index, $event)&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> item<span class="token punctuation">.</span>value <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
<span class="highlighted-line">    <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span></span><span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>

</code></pre><hr><ul><li>不支持过滤器
渲染部分会转成 wxml ，wxml 不支持过滤器，所以这部分功能不支持。</li></ul><hr><ul><li>不支持在template里面使用methods函数</li></ul><hr><ul><li>暂不支持在组件中使用 Class Style 绑定</li></ul><hr><ul><li>在列表渲染时，必须指定不同的索引值：</li></ul><pre class="language-js"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
 <span class="token operator">&lt;</span>ul v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;(itemUl, index) in list&quot;</span><span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>li v<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;(item, itemIndex) in itemUl&quot;</span><span class="token operator">&gt;</span>
<span class="highlighted-line">     <span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token punctuation">}</span></span>   <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
 <span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
</code></pre><ul><li>事件处理器 input &amp;&amp;  textarea中的change事件被转为blur事件</li></ul><hr><ul><li>事件修饰符</li></ul><ol><li>stop 的使用会阻止冒泡，但是同时绑定了一个非冒泡事件，会导致该元素上的 catchEventName 失效！</li><li>prevent 可以直接干掉，因为小程序里没有什么默认事件，比如submit并不会跳转页面</li><li>capture 支持 1.0.9</li><li>self 没有可以判断的标识</li><li>once 也不能做，因为小程序没有 removeEventListener, 虽然可以直接在 handleProxy 中处理，但非常的不优雅，违背了原意，暂不考虑</li></ol><h3 id="组件部分"><a href="#组件部分" aria-hidden="true" class="header-anchor">#</a> 组件部分</h3><p>有且只能使用单文件组件（.vue 组件）的形式进行支持。</p><ul><li>详细的不支持列表：</li></ul><ol><li><p>暂不支持在组件引用时，在组件上定义 click 等原生事件、v-show（可用 v-if 代替）和 class style 等样式属性(例：<card class="class-name"></card> 样式是不会生效的)，因为编译到 wxml，小程序不会生成节点，建议写在内部顶级元素上。</p></li><li><p>Slot（scoped 暂时还没做支持）</p></li><li><p>动态组件</p></li><li><p>异步组件</p></li><li><p>inline-template</p></li><li><p>X-Templates</p></li><li><p>keep-alive</p></li><li><p>transition</p></li><li><p>class</p></li><li><p>style</p></li></ol><h3>小程序组件</h3><p>mpvue 可以支持小程序的原生组件，比如： picker,map 等，需要注意的是原生组件上的事件绑定，需要以 vue 的事件绑定语法来绑定，如 bindchange=&quot;eventName&quot; 事件，需要写成 @change=&quot;eventName&quot;</p><p>示例代码：</p><pre class="language-js"><code><span class="token operator">&lt;</span>picker mode<span class="token operator">=</span><span class="token string">&quot;date&quot;</span> <span class="token punctuation">:</span>value<span class="token operator">=</span><span class="token string">&quot;date&quot;</span> start<span class="token operator">=</span><span class="token string">&quot;2015-09-01&quot;</span> end<span class="token operator">=</span><span class="token string">&quot;2017-09-01&quot;</span> @change<span class="token operator">=</span><span class="token string">&quot;bindDateChange&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;picker&quot;</span><span class="token operator">&gt;</span>
      当前选择<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>date<span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="highlighted-line">    <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span></span><span class="token operator">&lt;</span><span class="token operator">/</span>picker<span class="token operator">&gt;</span>
</code></pre><h3 id="优化建议："><a href="#优化建议：" aria-hidden="true" class="header-anchor">#</a> 优化建议：</h3><ul><li><p>精简data数据 不要太冗余，每次变更都会从微信小程序的 JSCore 进程，通过 setData 序列化成字符串后发送到 JSRender 进程。所以，如果你的数据量巨大的时候，会导致页面非常卡顿。</p></li><li><p>页面有大量数据时：</p></li></ul><ol><li><p>避免在v-for中嵌套子组件</p></li><li><p>通过实践发现 wx:if 和 hidden 的优化肉眼不可见，所以或许可以试试直接通过样式 display 来展示和隐藏。</p></li><li><p>合理使用双向绑定 mpvue 建议使用 v-model.lazy 绑定方式以优化性能，此外 v-model 在老基础库下输入框输入时可能存在光标重设的问题</p></li><li><p>谨慎选择直接使用小程序的 API 如果你有小程序和H5复用代码的需要，业务代码需要保持对 WEB Vue.js 的兼容性。此时我们不建议在代码中直接调用小程序API，更好的选择是通过桥接适配层屏蔽两端差异。</p></li></ol><h3 id="常见问题："><a href="#常见问题：" aria-hidden="true" class="header-anchor">#</a> 常见问题：</h3><ul><li>获取小程序在 page onLoad 时候传递的 options：</li></ul><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$root<span class="token punctuation">.</span>$mp<span class="token punctuation">.</span>query
</code></pre><ul><li>获取小程序在 app onLaunch/onShow 时候传递的 options</li></ul><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$root<span class="token punctuation">.</span>$mp<span class="token punctuation">.</span>appOptions
</code></pre><p>*捕获 app 的 onError
app.js</p><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
   <span class="token comment">// 只有 app 才会有 onLaunch 的生命周期</span>
   <span class="token function">onLaunch</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="highlighted-line">       <span class="token comment">// ...</span></span>   <span class="token punctuation">}</span><span class="token punctuation">,</span>

   <span class="token comment">// 捕获 app error</span>
   <span class="token function">onError</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><!----><div class="content page-nav"><p class="inner"><span class="prev">
        ← <a href="/catalog/study/WePY总结.html" class="prev">
          ➹ WePY总结
        </a></span><span class="next"><a href="/catalog/study/一些常用的Linux远程操作命令记录.html">
          ➹ 一些常用的 Linux 远程操作命令记录
        </a> →
      </span></p></div></div></div></div>
    <script src="/assets/js/7.c2b6ae81.js" defer></script><script src="/assets/js/app.5f6376b3.js" defer></script>
  </body>
</html>
